name: automated-sales-pipeline-dashboard
prefect-version: 3.4.6  #

build: null

push: null

pull:
  - prefect.deployments.steps.run_shell_script:
      id: download-flow-from-s3
      script: |
        echo "Setting AWS environment variables from secret..."
        export AWS_ACCESS_KEY_ID={{ prefect.blocks.secret.credentials.AWS_ACCESS_KEY_ID }}
        export AWS_SECRET_ACCESS_KEY={{ prefect.blocks.secret.credentials.AWS_SECRET_ACCESS_KEY }}
        export AWS_DEFAULT_REGION={{ prefect.blocks.secret.credentials.AWS_DEFAULT_REGION }}
        echo "Downloading flow code from S3..."
        aws s3 cp s3://your-bucket-name/flows/etl_flow.zip .
        unzip -o etl_flow.zip

deployments:
- name: etl-deployment
  version: null
  tags: []
  description: Deploys the main ETL pipeline flow
  schedule: {} 
  flow_name: main
  entrypoint: etl_pipeline/etl_flow.py:main
  parameters: {}
  work_pool:
    name: etl-workpool  
    work_queue_name: null  
    job_variables: {}
